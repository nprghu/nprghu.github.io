<!DOCTYPE html>

<html>
<head>
  <style>
    .column {
  padding: 5px;
  float: left;
  width: 40%;
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

.gradient-text {
  background: linear-gradient(to right, rgb(215, 141, 210), rgb(185, 153, 238), rgb(157, 165, 233), rgb(143, 169, 240));;
  background-clip: text;
  color: transparent;
}


.vertical-line {
    border-left: 1px solid gray;
  opacity: 10%;
    height: 1000px; /* Adjust the height as needed */
  }
  </style>

  <script>
    let slider = document.getElementById("myRange");
let output = document.getElementById("demo");
output.innerHTML = slider.value;
const numericInput = document.getElementById("numericInput");

let modnum = document.getElementById("mod");
let modneg = document.getElementById("neg?");
let mod = 0;

modnum.oninput = function() {
	if (modneg == "-") {
		mod = -Number(this.value);
	} else {
		mod = Number(this.value);
	}
};
modneg.oninput = function() {
	if (modneg == "-") {
		mod = -Number(this.value);
	} else {
		mod = Number(this.value);
	}
};
slider.oninput = function() {
	output.innerHTML = this.value;
};

function rollcover() {
	roll(slider.value, numericInput.value, mod);
}

function roll(importance, dice, modif) {
	let normal = Math.random() * (dice - 1) + 1;
	console.log(normal);
	let advantage = Math.min(Math.log(normal) * (dice + 1), 20);
	console.log(advantage);

	let final = 0;

	if (importance == 1) {
		final = normal;
	}
	if (importance == 2) {
		final = (normal + advantage) / 2;
	}
	if (importance == 3) {
		final = (normal + 2 * advantage) / 3;
		final = final / 2 + 10;
	}
	final = final + modif;
	console.log(final);
	const roll = document.getElementById("roll");
	roll.textContent = Math.round(final);
	const list = document.getElementById("myList");
	const firstLi = list.firstElementChild; // Get the first list item

	// Create the new list item
	const newLi = document.createElement("li");
	newLi.textContent =
		Math.round(final) + " (nat " + Math.round(final - mod) + ", d" + dice + ", /" + importance + ")";

	// Insert the new item at the beginning
	list.insertBefore(newLi, firstLi);
}

numericInput.addEventListener("input", (event) => {
  const value = event.target.value;
  // Replace any non-digit characters while keeping valid input intact
  event.target.value = value.replace(/[^0-9]/g, "");
});

  </script>
</head>
<body style="padding: 10px;" class="row">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.fluid.classless.min.css">
  
  <br>
  <h1 style="text-align: center;" class="gradient-text">Dice Roller </h1>
  <br>
  <hr>

  <div class="column" style="width: 60%">
    <div class="row">
      <div class="column" style="width: 34%">
        <h3 style="text-align: center">Importance</h3>
        <input type="range" min="1" max="3" value="1" id="myRange">
        <p style="text-align: center;">Importance: <b><span id="demo"></span></b></p>
      </div>

      <div class="column" style="width: 33%">
        <h3 style="text-align:center;">
          Dice Type
        </h3>
        <div class="row">
          <input style="width: 20%; height: 60px;" class="column" value="d" type="text" readonly>
          <input type="number" min="1" max="20" id="numericInput" style="width: 70%; height: 60px;" class="column" value="20">
        </div>
      </div>

      <div class="column" style="width: 33%">
        <h3 style="text-align: center;">Modifier</h3>
        <div class="row">
          <select type="dropdown" class="column" style="width: 45%; height: 60px;" id="neg?">
            <option value="+">+</option>
            <option value="-">-</option>
          </select>
          <input id="mod" type="number" style="width: 50%; height: 60px;" class="column" value="0">
        </div>
      </div>
    </div>
    
    <div style="padding: 10px;"><hr></div>
    
    <div class="row">
      <div class="column" style="width: 34%; text-align: center;">
        <h3>Clear List</h3>
        <button onclick="document.getElementById('myList').innerHTML = ''">Clear List</button>
      </div>

      <div class="column" style="width: 33%; text-align: center;">
        <h3 class="gradient-text">Home</h3>
        <button href="https://nprghu.github.io/index.html">Home</button>
      </div>
    </div>
    
  </div>
  
  <div class="column vertical-line" style="width: 1%">
  </div>
  
  <div class="column" style="width: 39%">
    <input type="button" value="Roll!" onclick="rollcover()"></input>
    <p style="text-align: center;"><kbd id="roll">Your Roll Appears Here</kbd></p>
    <hr>
    <ul id="myList">
    </ul>
  </div>
</body>
</html>
